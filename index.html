<!DOCTYPE html>
<html lang="et">
<head>
  <meta charset="UTF-8">
  <title>heeh.ee</title>

  <style>
    body {
      margin: 0;
      height: 100vh;
      background: black;
      overflow: hidden;
    }

    #dance {
      position: fixed;
      left: 0;
      bottom: 0;
      width: 70vw;
      max-height: 80vh;
      object-fit: contain;
      transition: transform 0.08s ease-out;
      cursor: pointer;
    }

    .hint {
      position: fixed;
      right: 12px;
      bottom: 12px;
      color: white;
      opacity: 0.6;
      font-family: Arial, sans-serif;
      font-size: 12px;
      pointer-events: none;
    }
  </style>
</head>

<body>
  <img id="dance" src="hehe-dance.gif" alt="dance">
  <div class="hint">ðŸ”Š sound on interaction</div>

  <!-- autoplay muted = allowed -->
  <audio id="music" autoplay loop muted>
    <source src="billijean.mp3" type="audio/mpeg">
  </audio>

  <script>
    const music = document.getElementById("music");
    const gif = document.getElementById("dance");
    const hint = document.querySelector(".hint");

    // Billie Jean BPM
    const BPM = 117;
    const beatInterval = 60000 / BPM;

    // Beat sync starts immediately
    setInterval(() => {
      gif.style.transform = "scale(1.06)";
      setTimeout(() => {
        gif.style.transform = "scale(1)";
      }, 80);
    }, beatInterval);

    let soundEnabled = false;

    function enableSound() {
      if (soundEnabled) return;
      soundEnabled = true;

      music.muted = false;
      music.volume = 0;

      const duration = 2000;
      const stepTime = 50;
      const steps = duration / stepTime;
      let step = 0;

      const fade = setInterval(() => {
        step++;
        music.volume = Math.min(step / steps, 1);
        if (music.volume >= 1) clearInterval(fade);
      }, stepTime);

      if (hint) hint.remove();

      // Remove all listeners after first success
      window.removeEventListener("click", enableSound);
      window.removeEventListener("mousemove", enableSound);
      window.removeEventListener("scroll", enableSound);
      window.removeEventListener("keydown", enableSound);
      window.removeEventListener("touchstart", enableSound);
    }

    // ANY interaction enables sound
    window.addEventListener("click", enableSound);
    window.addEventListener("mousemove", enableSound);
    window.addEventListener("scroll", enableSound);
    window.addEventListener("keydown", enableSound);
    window.addEventListener("touchstart", enableSound);

    // Explicitly also on GIF click (belt & suspenders)
    gif.addEventListener("click", enableSound);
  </script>
</body>
</html>
